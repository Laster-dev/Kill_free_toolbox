<Page x:Class="Kill_free_toolbox.Views.Pages.Page_Baijiahei"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:Kill_free_toolbox.Views.Pages"
      xmlns:controls="clr-namespace:Kill_free_toolbox.Views.Controls"
      mc:Ignorable="d" TextOptions.TextFormattingMode="Display"
        TextOptions.TextRenderingMode="ClearType"
        TextOptions.TextHintingMode="Fixed"
      d:DesignHeight="450" d:DesignWidth="800"
      Title="Page_Baijiahei">

    <TabControl>

        <TabItem Header="劫持代码生成">
            <Grid x:Name="IATHijackGrid" AllowDrop="True" DragOver="IATHijackGrid_DragOver" Drop="IATHijackGrid_Drop">
                <Grid.RowDefinitions>
                    <RowDefinition Height="36"/><!--文件选择-->
                    <RowDefinition Height="*"/><!--内容-->
                    <RowDefinition Height="24"/>
                    <!--文件选择-->
                </Grid.RowDefinitions>
                <Grid Grid.Row="0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        
                    </Grid.ColumnDefinitions>
                    <ComboBox x:Name="DllComboBox" Grid.Column="0" Height="32" Margin="1.5" SelectionChanged="DllComboBox_SelectionChanged" FontFamily="Cascadia Code" FontSize="12"/>


                    <Button x:Name="BrowseButton"  
                            Grid.Column="2"
                            Margin="2"
                             Height="32" Width="180"
                            Content="浏览文件" 
                            Click="BrowseButton_Click"/>
                    


                </Grid>
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="3*"/>
                    </Grid.ColumnDefinitions>
                    <!--左侧列表-->
                    <StackPanel>
                        

                        <!--白文件文件信息：图标,架构，签名有效性，-->
                        <Border BorderThickness="1" CornerRadius="8" BorderBrush="AliceBlue" Width="128" Height="128"  Margin="0,15,0,15">
                            <Image x:Name="FileIconImage" Height="100" Width="100">
                                <Image.Clip>
                                    <RectangleGeometry RadiusX="10" RadiusY="10" Rect="0,0,150,150"/>
                                </Image.Clip>
                            </Image>
                        </Border>

                        <TextBlock x:Name="ArchTextBlock" Text="架构：-" Margin="8,4,8,0"/>
                        <TextBlock x:Name="SignatureTextBlock" Text="签名：-" Margin="8,4,8,8"/>
                        <CheckBox x:Name="ForwardToOriginalCheckBox" Content="转发到原始dll" IsChecked="True" Margin="0,4,0,0" HorizontalAlignment="Center"/>
                        <CheckBox x:Name="AutoGenerateCheckBox" IsChecked="False" Margin="0,4,0,0" Content="完美劫持入口" HorizontalAlignment="Center"/>
                        <Button x:Name="GenerateProjectButton"
          Grid.Column="4"
          Margin="8"
          Height="32"
          Content="生成劫持项目"
          Click="GenerateProjectButton_Click"/>
                    </StackPanel>
                    <ScrollViewer  Grid.Column="1" Margin="2" >
                        <RichTextBox x:Name="CppCodeTextBox"
          Margin="-1.5" 
          AcceptsReturn="True" 
          AcceptsTab="True"
          VerticalScrollBarVisibility="Auto" 
          HorizontalScrollBarVisibility="Auto"
          FontFamily="Cascadia Code" 
          FontSize="12"
          Background="#FF1E1E1E"
          Foreground="#FFDCDCDC"
          BorderBrush="#FF3C3C3C"
          BorderThickness="1"
          Padding="10"
          CaretBrush="#FFDCDCDC">
                            <RichTextBox.Resources>
                                <CornerRadius x:Key="TextInputCornerRadius">0</CornerRadius>
                            </RichTextBox.Resources>
                        </RichTextBox>
                    </ScrollViewer>
                </Grid>
                <TextBlock x:Name="FilePathTextBox"  Grid.Row="2"
         Grid.Column="0"
         Height="24" Margin="5,0,0,0"
         Text="请选择要劫持的白文件..." VerticalAlignment="Bottom" HorizontalAlignment="Left"/>


            </Grid>
           
        </TabItem>
        <TabItem Header="白文件搜索">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="36"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>

                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <ComboBox x:Name="DriveComboBox" Height="28"/><!--选择盘符-->
                    <CheckBox x:Name="SingleDllCheckBox" Content="DLL劫持数量" Margin="8,0,0,0" VerticalAlignment="Center" Grid.Column="1"/>
                    <!--数字输入框-->
                    <TextBox x:Name="DllCountTextBox"
                             Text="1" InputMethod.IsInputMethodEnabled="False"
         PreviewTextInput="DllCountTextBox_PreviewTextInput"
                                             Width="60" 
                                             Height="28" 
                                             Margin="3,0,5,0" 
                                             VerticalAlignment="Center" 
                                             Grid.Column="2" />
                    <CheckBox x:Name="SizeLimitCheckBox" Content="限制大小" IsChecked="True" Margin="8,0,0,0" VerticalAlignment="Center" Grid.Column="3"/>
                    <TextBox x:Name="SizeLimitTextBox" Text="2MB" Height="28" Grid.Column="4" Width="60" Margin="3,0,5,0"/>
                    <CheckBox x:Name="MoveToDirectoryCheckBox" Content="迁移目录" IsChecked="False" Grid.Column="5"/>
                    <Button x:Name="StartSearchButton" Content="开始搜索" Grid.Column="6" Margin="3" Click="StartSearchButton_Click"/>
                    <Button x:Name="StopSearchButton" Content="停止搜索" Grid.Column="7" Margin="3" Click="StopSearchButton_Click" IsEnabled="False" Visibility="Collapsed"/>
                </Grid>
                <Grid Grid.Row="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- 搜索状态栏 -->
                    <Border x:Name="SearchStatusBar" Grid.Row="0" 
                           BorderThickness="0,0,0,1" Padding="8,4" Visibility="Collapsed">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock x:Name="SearchStatusText" Text="正在搜索..." FontSize="12" Foreground="#666666" VerticalAlignment="Center"/>
                            <TextBlock x:Name="SearchCountText" Text="已找到: 0 个" FontSize="12" Foreground="#007ACC" 
                                      Margin="20,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                    
                    <ListBox x:Name="SearchResultsListBox" Grid.Row="1" SelectionMode="Extended" 
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                    <ListBox.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="迁移到目录" Click="MoveSelectedFilesMenuItem_Click"/>
                            <MenuItem Header="打开文件位置" Click="OpenFileLocationMenuItem_Click"/>
                            <MenuItem Header="复制文件路径" Click="CopyFilePathMenuItem_Click"/>
                        </ContextMenu>
                    </ListBox.ContextMenu>
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <controls:WhiteFileSearchResultItem SearchResult="{Binding}"/>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                    </ListBox>
                </Grid>
            </Grid>
        </TabItem>
        <TabItem Header=".Net白搜索">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="36"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <ComboBox x:Name="DotNetDriveComboBox" Height="28"/><!--选择盘符-->
                    <CheckBox x:Name="DotNetSizeLimitCheckBox" Content="限制大小" IsChecked="True" Margin="8,0,0,0" VerticalAlignment="Center" Grid.Column="1"/>
                    <TextBox x:Name="DotNetSizeLimitTextBox" Text="2MB" Height="28" Grid.Column="2" Width="60" Margin="3,0,5,0"/>
                    <CheckBox x:Name="DotNetMoveToDirectoryCheckBox" Content="迁移目录" IsChecked="False" Grid.Column="3"/>
                    <Button x:Name="DotNetStartSearchButton" Content="开始搜索" Grid.Column="4" Margin="3" Click="DotNetStartSearchButton_Click"/>
                    <Button x:Name="DotNetStopSearchButton" Content="停止搜索" Grid.Column="4" Margin="3" Click="DotNetStopSearchButton_Click" IsEnabled="False" Visibility="Collapsed"/>
                </Grid>
                <Grid Grid.Row="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- 搜索状态栏 -->
                    <Border x:Name="DotNetSearchStatusBar" Grid.Row="0"
                           BorderThickness="0,0,0,1" Padding="8,4" Visibility="Collapsed">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock x:Name="DotNetSearchStatusText" Text="正在搜索..." FontSize="12" Foreground="#666666" VerticalAlignment="Center"/>
                            <TextBlock x:Name="DotNetSearchCountText" Text="已找到: 0 个" FontSize="12" Foreground="#007ACC" 
                                      Margin="20,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- 分类显示区域 -->
                    <TabControl x:Name="DotNetResultsTabControl" Grid.Row="1">
                        <TabItem Header="有签名">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid Grid.Column="0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <StackPanel  Orientation="Horizontal" >
                                        <TextBlock Text="GUI程序" FontWeight="Bold"  VerticalAlignment="Center"/>
                                        <TextBlock x:Name="DotNetSignedGuiCountText" Text="0 个" Foreground="#007ACC" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <ListBox Margin="2" x:Name="DotNetSignedGuiListBox" Grid.Row="1" SelectionMode="Extended" 
         ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                        <ListBox.ContextMenu>
                                            <ContextMenu>
                                                <MenuItem Header="迁移到目录" Click="DotNetMoveSelectedFilesMenuItem_Click"/>
                                                <MenuItem Header="打开文件位置" Click="DotNetOpenFileLocationMenuItem_Click"/>
                                                <MenuItem Header="复制文件路径" Click="DotNetCopyFilePathMenuItem_Click"/>
                                            </ContextMenu>
                                        </ListBox.ContextMenu>
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <controls:DotNetSearchResultItem SearchResult="{Binding}"/>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>
                                </Grid>
                                <Grid Grid.Column="1">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="CUI程序" FontWeight="Bold"  VerticalAlignment="Center"/>
                                        <TextBlock x:Name="DotNetSignedCuiCountText" Text="0 个" Foreground="#FF9800" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <ListBox Margin="2" x:Name="DotNetSignedCuiListBox" Grid.Row="1" SelectionMode="Extended"
         ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                        <ListBox.ContextMenu>
                                            <ContextMenu>
                                                <MenuItem Header="迁移到目录" Click="DotNetMoveSelectedFilesMenuItem_Click"/>
                                                <MenuItem Header="打开文件位置" Click="DotNetOpenFileLocationMenuItem_Click"/>
                                                <MenuItem Header="复制文件路径" Click="DotNetCopyFilePathMenuItem_Click"/>
                                            </ContextMenu>
                                        </ListBox.ContextMenu>
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <controls:DotNetSearchResultItem SearchResult="{Binding}"/>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>
                                </Grid>

                               
                            </Grid>
                        </TabItem>
                        <TabItem Header="过期签名">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <StackPanel Grid.Row="0" Orientation="Horizontal">
                                        <TextBlock Text="GUI程序" FontWeight="Bold" HorizontalAlignment="Left" VerticalAlignment="Center" />
                                        <TextBlock x:Name="DotNetExpiredGuiCountText" Text="0 个" Foreground="#FF6B00" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                                    </StackPanel>
                                    <ListBox x:Name="DotNetExpiredGuiListBox" Margin="2" Grid.Row="1" SelectionMode="Extended" 
         ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                        <ListBox.ContextMenu>
                                            <ContextMenu>
                                                <MenuItem Header="迁移到目录" Click="DotNetMoveSelectedFilesMenuItem_Click"/>
                                                <MenuItem Header="打开文件位置" Click="DotNetOpenFileLocationMenuItem_Click"/>
                                                <MenuItem Header="复制文件路径" Click="DotNetCopyFilePathMenuItem_Click"/>
                                            </ContextMenu>
                                        </ListBox.ContextMenu>
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <controls:DotNetSearchResultItem SearchResult="{Binding}"/>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>
                                </Grid>
                                <Grid Grid.Column="1">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                 
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="CUI程序" FontWeight="Bold"  VerticalAlignment="Center"/>
                                        <TextBlock x:Name="DotNetExpiredCuiCountText" Text="0 个" Foreground="#FF5722" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <ListBox x:Name="DotNetExpiredCuiListBox" Margin="2" Grid.Row="1" SelectionMode="Extended" 
         ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                        <ListBox.ContextMenu>
                                            <ContextMenu>
                                                <MenuItem Header="迁移到目录" Click="DotNetMoveSelectedFilesMenuItem_Click"/>
                                                <MenuItem Header="打开文件位置" Click="DotNetOpenFileLocationMenuItem_Click"/>
                                                <MenuItem Header="复制文件路径" Click="DotNetCopyFilePathMenuItem_Click"/>
                                            </ContextMenu>
                                        </ListBox.ContextMenu>
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <controls:DotNetSearchResultItem SearchResult="{Binding}"/>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>
                                </Grid>


                                
                                
                            </Grid>
                        </TabItem>
                    </TabControl>
                </Grid>
            </Grid>
        </TabItem>
    </TabControl>
</Page>
