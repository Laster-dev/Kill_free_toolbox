<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    
    <!-- 现代菜单按钮样式（全局默认） -->
    <Style TargetType="RadioButton">
        <Setter Property="Height" Value="46"/>
        <Setter Property="FontSize" Value="14"/>
        <Setter Property="Foreground" Value="{DynamicResource PrimaryForeground}"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Padding" Value="25,0"/>
        <Setter Property="Margin" Value="8,2,8,2"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="RadioButton">
                    <Grid>
                        <!-- 底层背景 (带圆角) -->
                        <Rectangle x:Name="Background" Fill="Transparent" RadiusX="8" RadiusY="8"/>

                        <!-- 悬停指示器 (带圆角) -->
                        <Rectangle x:Name="HoverIndicator" 
                    Fill="{DynamicResource HoverBrush}" 
                    Opacity="0"
                    RadiusX="8" RadiusY="8"/>

                        <!-- 选中指示器背景 (带圆角) -->
                        <Rectangle x:Name="SelectionBackground" 
                    Fill="{DynamicResource SelectedBrush}" 
                    Opacity="0"
                    RadiusX="8" RadiusY="8"/>

                        <!-- 左侧选中指示条 (圆角化处理) -->
                        <Border x:Name="SelectionIndicator"
                 Width="4" 
                 Height="22"
                 HorizontalAlignment="Left"
                 VerticalAlignment="Center"
                 Margin="6,0,0,0"
                 Background="{DynamicResource InfoBrush}" 
                 CornerRadius="2"
                 Opacity="0"/>

                        <!-- 内容 -->
                        <ContentPresenter 
             VerticalAlignment="Center" 
             HorizontalAlignment="Left" 
             Margin="{TemplateBinding Padding}"/>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <!-- 选中状态 -->
                        <Trigger Property="IsChecked" Value="True">
                            <Setter TargetName="SelectionBackground" Property="Opacity" Value="1"/>
                            <Setter TargetName="SelectionIndicator" Property="Opacity" Value="1"/>
                            <Setter Property="Foreground" Value="{DynamicResource InfoBrush}"/>
                        </Trigger>

                        <!-- 悬停但未选中状态 -->
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True"/>
                                <Condition Property="IsChecked" Value="False"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="HoverIndicator" Property="Opacity" Value="1"/>
                        </MultiTrigger>

                        <!-- 悬停且已选中状态 - 使用微妙的悬停效果 -->
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver" Value="True"/>
                                <Condition Property="IsChecked" Value="True"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="SelectionBackground" Property="Opacity" Value="0.9"/>
                            <Setter TargetName="SelectionIndicator" Property="Opacity" Value="1"/>
                        </MultiTrigger>

                        <!-- 鼠标按下状态 -->
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="HoverIndicator" Property="Fill" Value="{DynamicResource PressedBrush}"/>
                            <Setter TargetName="HoverIndicator" Property="Opacity" Value="1"/>
                        </Trigger>

                        <!-- 禁用状态 -->
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Foreground" Value="{DynamicResource DisabledForeground}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- 普通菜单项模板，去除图标区域 -->
    <ControlTemplate x:Key="SubmenuItemTemplateKey" TargetType="{x:Type MenuItem}">
        <Border x:Name="Bd" Background="{TemplateBinding Background}" CornerRadius="6">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <ContentPresenter Grid.Column="0"
                                  ContentSource="Header"
                                  Margin="{TemplateBinding Padding}"
                                  RecognizesAccessKey="True"
                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                  VerticalAlignment="Center"/>
            </Grid>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="Bd" Property="Background" Value="{DynamicResource ContextMenuItemHoverBackground}"/>
            </Trigger>
            <Trigger Property="IsChecked" Value="True">
                <Setter TargetName="Bd" Property="Background" Value="{DynamicResource ContextMenuItemHoverBackground}"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- 子菜单Header模板，去除图标区域 -->
    <ControlTemplate x:Key="SubmenuHeaderTemplateKey" TargetType="{x:Type MenuItem}">
        <Border x:Name="Bd" CornerRadius="6" Background="{TemplateBinding Background}" BorderThickness="0">
            <Grid SnapsToDevicePixels="true">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="30"/>
                    </Grid.ColumnDefinitions>
                    <ContentPresenter Grid.Column="0" ContentSource="Header" Margin="{TemplateBinding Padding}" RecognizesAccessKey="True"
                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="Center"/>
                    <Path Grid.Column="1" Width="16" Height="16" Stretch="Uniform" Data="{StaticResource RightArrow}" Fill="{TemplateBinding Foreground}"
                          HorizontalAlignment="Left" Margin="0,0,20,0"/>
                </Grid>
                <Popup x:Name="PART_Popup" AllowsTransparency="true" HorizontalOffset="-1"
                       IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}"
                       PopupAnimation="Scroll" Placement="Right" VerticalOffset="0">
                    <Border Margin="0,0" CornerRadius="6" Background="{DynamicResource ContextMenuBackground}" BorderBrush="{DynamicResource ContextMenuBorderBrush}" BorderThickness="1" MinWidth="120">
                        <ItemsPresenter x:Name="ItemsPresenter" KeyboardNavigation.DirectionalNavigation="Cycle"
                                        Grid.IsSharedSizeScope="true" Margin="0" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                        KeyboardNavigation.TabNavigation="Cycle"/>
                    </Border>
                </Popup>
            </Grid>
        </Border>
        <ControlTemplate.Triggers>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="HasItems" Value="true"/>
                    <Condition Property="IsMouseOver" Value="true"/>
                </MultiTrigger.Conditions>
                <Setter Property="IsSubmenuOpen" Value="true"/>
                <Setter Property="Background" Value="{DynamicResource ContextMenuItemHoverBackground}"/>
                <Setter TargetName="PART_Popup" Property="IsOpen" Value="true"/>
            </MultiTrigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="HasItems" Value="true"/>
                    <Condition Property="IsChecked" Value="true"/>
                    <Condition Property="IsMouseOver" Value="true"/>
                </MultiTrigger.Conditions>
                <Setter Property="IsSubmenuOpen" Value="true"/>
                <Setter Property="Background" Value="{DynamicResource ContextMenuItemHoverBackground}"/>
                <Setter TargetName="PART_Popup" Property="IsOpen" Value="true"/>
            </MultiTrigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- 右箭头Path资源 -->
    <PathGeometry x:Key="RightArrow">M 4 0 L 12 8 L 4 16</PathGeometry>

    <!-- 全局MenuItem样式，紧凑、对比度高、内容正常显示 -->
    <Style TargetType="{x:Type MenuItem}">
        <Setter Property="Background" Value="{DynamicResource ContextMenuItemBackground}"/>
        <Setter Property="Foreground" Value="{DynamicResource ContextMenuItemForeground}"/>
        <Setter Property="ScrollViewer.PanningMode" Value="Both"/>
        <Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
        <Setter Property="FontSize" Value="14"/>
        <Setter Property="Height" Value="38"/>
        <Setter Property="Margin" Value="0,2,0,0"/>
        <Setter Property="Padding" Value="10,0,10,0"/>
        <Setter Property="Template" Value="{StaticResource SubmenuItemTemplateKey}"/>
        <Style.Triggers>
            <Trigger Property="Role" Value="SubmenuHeader">
                <Setter Property="Template" Value="{StaticResource SubmenuHeaderTemplateKey}"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- 全局ContextMenu样式，圆角、阴影、主题色自适应 -->
    <Style TargetType="{x:Type ContextMenu}">
        <Setter Property="Background" Value="{DynamicResource ContextMenuBackground}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource ContextMenuBorderBrush}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="SnapsToDevicePixels" Value="True"/>
        <Setter Property="OverridesDefaultStyle" Value="True"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ContextMenu">
                    <Border x:Name="Border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="8"
                            SnapsToDevicePixels="True"
                            ClipToBounds="True"
                            Effect="{DynamicResource ContextMenuShadowEffect}">
                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle"/>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- 阴影效果资源（可在App.xaml或主题色里定义） -->
    <DropShadowEffect x:Key="ContextMenuShadowEffect" BlurRadius="12" ShadowDepth="2" Color="#44000000"/>

</ResourceDictionary>
